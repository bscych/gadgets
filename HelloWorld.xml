<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="Calendar" title_url="http://www.igoogleportal.com" description="With this online calendar, it's easy to keep track of life's important events all in one place." author="iGoogle Portal" author_email="contactus+feedback@igoogleportal.com" screenshot="http://www.igoogleportal.com/gadget/calendar/image.png" thumbnail="http://www.igoogleportal.com/gadget/calendar/image.png" category="tools" height="150">
<Require feature="dynamic-height"/>
<Require feature="views"/>
</ModulePrefs>
<!--  Font color's  -->
<UserPref name="ftcolor" display_name="Events font Color" datatype="enum" default_value="#000000">
<EnumValue value="#000000" display_value="Black"/>
<EnumValue value="#FFFF00" display_value="Yellow"/>
<EnumValue value="#0000FF" display_value="Blue"/>
<EnumValue value="#FF0000" display_value="Red"/>
<EnumValue value="#00FF00" display_value="Green"/>
<EnumValue value="#FFA500" display_value="Orange"/>
<EnumValue value="#A52A2A" display_value="Brown"/>
<EnumValue value="#800080" display_value="Purple"/>
</UserPref>
<!--  Font size  -->
<UserPref name="ftsize" display_name="Events font Size" datatype="enum" default_value="15px">
<EnumValue value="13px" display_value="13px"/>
<EnumValue value="15px" display_value="15px"/>
<EnumValue value="17px" display_value="17px"/>
<EnumValue value="19px" display_value="19px"/>
<EnumValue value="21px" display_value="21px"/>
</UserPref>
<Content type="html" view="default, home, profile, canvas">
<![CDATA[
<head> <link rel="stylesheet" type="text/css" href="http://www.igoogleportal.com/gadget/css/buttons.css" /> <style> .body { font-family: 'Lucida Grande', 'Helvetica Neue', sans-serif; font-size: 15px; } .title_link { text-decoration: none; color: #000000; } .add_contact { padding-top: 10px; } .error_msg { font-size: 11px; color: #A8A8A8; padding-left: 2px; } input[type="text"] { display: block; margin: 0; width: 100%; font-family: sans-serif; font-size: 16px; appearance: none; box-shadow: none; border-radius: none; } input[type="text"]:focus { outline: none; } .style-1 input[type="text"] { padding: 6px; border: solid 1px #dcdcdc; transition: box-shadow 0.3s, border 0.3s; margin-bottom: 10px; } .style-1 input[type="text"]:focus, .style-1 input[type="text"].focus { border: solid 1px #707070; box-shadow: 0 0 5px 1px #969696; } </style> <script type="text/javascript" src="http://www.igoogleportal.com/lib/jquery-1.11.3/jquery.min.js"></script> <script type="text/javascript"> var prefs = new gadgets.Prefs(); var ftcolor = prefs.getString("ftcolor"); var ftsize = prefs.getString("ftsize"); var date_module = new Date(); var events_module = []; var months_array = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']; var incind = 0; // Object array function link_obj(id,title,comments,pubdate,time,ampm,endtime){ this.id=id; this.title=title; this.comments=comments; this.pubdate=pubdate; this.time=time; this.ampm=ampm; this.endtime=endtime; }; // Get calendar events from DataBase for Month get_module=function() { var month = date_module.getMonth()+1; var year = date_module.getFullYear(); events_module = []; $.ajax({ url: "http://www.igoogleportal.com/gadget/calendar/get-calendar.php", data: {month: month, year:year}, type: "GET", dataType: 'XML', cache: false, async: true, success: function(data, textStatus, jqXHR) { $(data).find('header').each(function() { var status = parseInt($(this).find('status').text()); if (status) { incind = 0; $(data).find('event').each(function() { var id = parseInt($(this).find('id').text()); var title = $(this).find('title').text(); var comments = $(this).find('comments').text(); var pubdate = $(this).find('pubdate').text(); var time = $(this).find('time').text(); var ampm = $(this).find('ampm').text(); var endtime = $(this).find('endtime').text(); events_module[incind] = new link_obj(id,title,comments,pubdate,time,ampm,endtime); incind++; }); } }); // Display calendar displayMonth_module(); } }); } // Display month calendar displayMonth_module=function() { noopt_module(); var l_s = '<table cellpadding="0" cellspacing="0" style="border: 1px solid #0E679A;" width="100%">' + '<tr style="background: #E9EDF2;">' + '<td style="text-align: center;height: 20px;">' + '<a href="#" onclick="return prev_module()"><img src="http://www.igoogleportal.com/gadget/calendar/ico_previous.gif" /></a>' + '</td>' + "<td colspan='5' id='currdate_module' style='text-align:center'>" + showdate_module() + '</td>' + '<td style="text-align:center">' + '<a href="#" onclick="return next_module();"><img src="http://www.igoogleportal.com/gadget/calendar/ico_next.gif" /></a>' + '</td>' + '</tr>' + '<tr style="background: #E9EDF2;">' + "<td style='width: 20px;height: 20px;text-align: center;'>Mo</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>Tu</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>We</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>Th</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>Fr</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>Sa</td>" + "<td style='width: 20px;height: 20px;text-align: center;'>Su</td>" + "</tr>"; var current_month = new Date().getMonth()+1; var l_date = new Date(date_module.getFullYear(),date_module.getMonth(),1), l_today = new Date, inc = 0, l_day, l_month = l_date.getMonth()+1, l_yea = l_date.getFullYear(), xmlinc = 0, l_comment; var l_start = (l_date.getDay() == 0 ? 7 : l_date.getDay()); for (var i = 1;i < l_start;i++) { if (i == 1) l_s += "<tr>"; l_s += "<td style='width: 20px;height: 20px;text-align: center;'></td>"; inc++; } while ((l_date.getMonth()) == date_module.getMonth()) { if (inc % 7 == 0) l_s += "<tr>"; l_day = l_date.getDate(); l_comment = ""; if (l_day == l_today.getDate() && l_month==current_month) { l_s+="<td style='width:27px;height:24px;text-align:center;font-weight:bold;color:#ffffff;cursor:pointer;cursor:hand;border:1px solid #FFFFFF;' bgcolor='green'>"+l_day+"</td>"; } else { l_s+="<td style='width:27px;height:24px;text-align:center;font-weight:bold;' bgcolor='#ffffff'>"+l_day+"</td>"; } l_date.setDate(l_date.getDate()+1); inc++; if (inc % 7 == 0) l_s += "</tr>"; } $("#ev_module").empty(); $("#ev_module").append(l_s); displayMonthEvents_module(); } // Display add event form opt_module=function(obj) { var l_s = ""; var hour = ["","","","","","","","","","","","","","","","","","","","","","","",""]; hour[new Date().getHours()+1] = "selected"; l_s+="<form name='f_module' action='' onsubmit='add_module(this);return false;'>" +"<table cellpadding='1' cellspacing='0'>" +"<tr><td class='style-1'><input type='text' name='title' maxlength='64' size='32' placeholder=': enter event title'/></td></tr>" +"<tr><td class='style-1'><input type='text' name='comment' maxlength='250' size='35' placeholder=': enter event comment'/></td></tr>" +"<tr><td style='padding-top:10px;'><select name='day'><option value='1'>01</option><option value='2'>02</option><option value='3'>03</option><option value='4'>04</option><option value='5'>05</option><option value='6'>06</option><option value='7'>07</option><option value='8'>08</option><option value='9'>09</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='13'>13</option><option value='14'>14</option><option value='15'>15</option><option value='16'>16</option><option value='17'>17</option><option value='18'>18</option><option value='19'>19</option><option value='20'>20</option><option value='21'>21</option><option value='22'>22</option><option value='23'>23</option><option value='24'>24</option><option value='25'>25</option><option value='26'>26</option><option value='27'>27</option><option value='28'>28</option><option value='29'>29</option><option value='30'>30</option><option value='31'>31</option></select>" +"<select name='month'><option value='1'>"+months_array[0]+"</option><option value='2'>"+months_array[1]+"</option><option value='3'>"+months_array[2]+"</option><option value='4'>"+months_array[3]+"</option><option value='5'>"+months_array[4]+"</option><option value='6'>"+months_array[5]+"</option><option value='7'>"+months_array[6]+"</option><option value='8'>"+months_array[7]+"</option><option value='9'>"+months_array[8]+"</option><option value='10'>"+months_array[9]+"</option><option value='11'>"+months_array[10]+"</option><option value='12'>"+months_array[11]+"</option></select>" +"<select name='year'><option value='2015'>2015</option><option value='2016'>2016</option><option value='2017'>2017</option><option value='2018'>2018</option><option value='2019'>2019</option><option value='2020'>2020</option><option value='2021'>2021</option><option value='2022'>2022</option><option value='2023'>2023</option><option value='2024'>2024</option><option value='2025'>2025</option></select></td></tr>" +"<tr><td style='padding-top:10px;'>from : <select name='hour'><option value='00'>00 h</option><option value='01'>01 h</option><option value='02'>02 h</option><option value='03'>03 h</option><option value='04'>04 h</option><option value='05'>05 h</option><option value='06'>06 h</option><option value='07'>07 h</option><option value='08'>08 h</option><option value='09'>09 h</option><option selected value='10'>10 h</option><option value='11'>11h</option><option value='12'>12 h</option><option value='13'>13 h</option><option value='14'>14h</option><option value='15'>15 h</option><option value='16'>16 h</option><option value='17'>17 h</option><option value='18'>18 h</option><option value='19'>19 h</option><option value='20'>20 h</option><option value='21'>21 h</option><option value='22'>22 h</option><option value='23'>23 h</option></select> " +"<select name='minute'><option value='00'>00 mn</option><option value='05'>05 mn</option><option value='10'>10 mn</option><option value='15'>15 mn</option><option value='20'>20 mn</option><option value='25'>25 mn</option><option value='30'>30 mn</option><option value='35'>35 mn</option><option value='40'>40 mn</option><option value='45'>45 mn</option><option value='50'>50 mn</option><option value='55'>55 mn</option></select></td></tr>" +"<tr><td style='padding-top:10px;'>until : <select name='hourend'><option value='00'>00 h</option><option value='01'>01 h</option><option value='02'>02 h</option><option value='03'>03 h</option><option value='04'>04 h</option><option value='05'>05 h</option><option value='06'>06 h</option><option value='07'>07 h</option><option value='08'>08 h</option><option value='09'>09 h</option><option value='10'>10 h</option><option value='11'>11h</option><option value='12'>12 h</option><option value='13'>13 h</option><option value='14'>14h</option><option value='15'>15 h</option><option value='16'>16 h</option><option value='17'>17 h</option><option selected value='18'>18 h</option><option value='19'>19 h</option><option value='20'>20 h</option><option value='21'>21 h</option><option value='22'>22 h</option><option value='23'>23 h</option></select> " +"<select name='minuteend'><option value='00'>00 mn</option><option value='05'>05 mn</option><option value='10'>10 mn</option><option value='15'>15 mn</option><option value='20'>20 mn</option><option value='25'>25 mn</option><option value='30'>30 mn</option><option value='35'>35 mn</option><option value='40'>40 mn</option><option value='45'>45 mn</option><option value='50'>50 mn</option><option value='55'>55 mn</option></select></td></tr>" +"<tr><td style='padding-top:10px;'></td></tr>" +"<tr><td><input class='button blue' type='submit' value='Add event' /> <input class='button default' type='button' onclick='noopt_module();return false;' value='Cancel' /></td></tr></table></form>"; $("#addb_module").empty(); $("#addb_module").append(l_s); l_form=document.forms["f_module"]; l_form.year.value=date_module.getFullYear(); l_form.month.value=(date_module.getMonth()+1); l_form.day.value=date_module.getDate(); // Adjust height of the gadget _IG_AdjustIFrameHeight(); } // convert javascript date to mysql date format function getDbFormat(v_day, v_month, v_year) { v_month = ("00").substr(0, 2 - v_month.length) + v_month; v_day = ("00").substr(0, 2 - v_day.length) + v_day; return v_year + "-" + v_month + "-" + v_day; }; // store event in database function add_module(v_form) { var stime=v_form.hour.value+":"+v_form.minute.value; var etime=v_form.hourend.value+":"+v_form.minuteend.value; if (etime<stime){ var l_s = 'Please enter correct end time'; $("#error_msg").empty(); $("#error_msg").append(l_s); return; } var ndate=getDbFormat(v_form.day.value,v_form.month.value,v_form.year.value); var otitle=v_form.title.value; var ocomment=v_form.comment.value; if(otitle == '') { var l_s = 'Please enter correct event title'; $("#error_msg").empty(); $("#error_msg").append(l_s); return; } $.ajax({ url: "http://www.igoogleportal.com/gadget/calendar/set-calendar.php", data: {title: otitle, comments: ocomment, pubdate: ndate, time: stime, endtime: etime, action:'ADD'}, type: "POST", dataType: 'XML', cache: false, async: true, success: function (data, textStatus, jqXHR) { $(data).find('header').each(function () { var status = parseInt($(this).find('status').text()); var l_s = $(this).find('msg').text(); $("#error_msg").empty(); $("#error_msg").append(l_s); if (status) { // var id = parseInt($(this).find('id').text()); // events_module[incind] = new link_obj(id,otitle,ocomment,ndate,stime,'A',etime); // incind++; get_module(); } }); } }); }; // Add event button noopt_module=function(){ var l_s = "<a href='#' class='button blue' onclick='opt_module();return false;'>Add event</a>"; $("#addb_module").empty(); $("#addb_module").append(l_s); // Adjust height of the gadget _IG_AdjustIFrameHeight(); } // Next Month next_module=function(){ date_module.setMonth(date_module.getMonth()+1); $("#error_msg").empty(); get_module(); return false; } // Previous Month prev_module=function(){ date_module.setMonth(date_module.getMonth()-1); $("#error_msg").empty(); get_module(); return false; } // Show Date showdate_module=function(){ var mon = date_module.getMonth(); var dat = date_module.getDate(); var yea = date_module.getFullYear(); return "<b>" + months_array[mon] + " " + yea + "</b>"; } // Display Current month events displayMonthEvents_module=function() { var l_s = '<p><b>Next events for this month :</b><br/></p>'; var l_e = '<p>No Events</p>'; var l_l = ''; var today = new Date(); var current_day = today.getDate(); var current_month = today.getMonth()+1; $.each( events_module, function( i, val ) { var date_array = events_module[i].pubdate.split("-"); var day = date_array[2]; var month = date_array[1]; var year = date_array[0]; if (month == current_month) { if (day >= current_day) { l_l += '<p><a class="title_link" id="link'+ i +'" href="#" onclick="detail_event('+i+');return false;" style="color:' + ftcolor + '; font-size:' + ftsize + ';">' + day + '/' + month + '/' + year + ' ' + events_module[i].time + '&raquo;' + events_module[i].endtime + ' ' + events_module[i].title +'</a></p>'; } } else { l_l += '<p><a class="title_link" id="link'+ i +'" href="#" onclick="detail_event('+i+');return false;" style="color:' + ftcolor + '; font-size:' + ftsize + ';">' + day + '/' + month + '/' + year + ' ' + events_module[i].time + '&raquo;' + events_module[i].endtime + ' ' + events_module[i].title +'</a></p>'; } }); if (l_l) l_s += l_l; else l_s += l_e; $("#ev_list_module").empty(); $("#ev_list_module").append(l_s); // Adjust height of the gadget _IG_AdjustIFrameHeight(); } // Display event details function detail_event(i){ var date_array = events_module[i].pubdate.split("-"); var day = date_array[2]; var month = date_array[1]; var year = date_array[0]; var l_s = "<p style='color:" + ftcolor + "; font-size:" + ftsize + ";'><b>"+events_module[i].title+"</b></p>"; l_s+= "<p style='color:" + ftcolor + "; font-size:" + ftsize + ";'>"+events_module[i].comments+"</p>"; l_s+= "<p style='color:" + ftcolor + "; font-size:" + ftsize + ";'>"+day+"/"+month+"/"+year+" from "+events_module[i].time+" to "+events_module[i].endtime+"</p>"; l_s+= "<center style='padding-top: 10px;'>"; l_s+= "<input class='button red' type='button' onclick='delete_event("+i+");return false;' value='Delete' /> "; l_s+= "<input type='button' onclick='displayMonth_module();return false;' value='Go back' class='button default' />"; l_s+= "</center>"; // Display Details $("#ev_list_module").empty(); $("#addb_module").empty(); $("#error_msg").empty(); $("#ev_list_module").append(l_s); // Adjust height of the gadget _IG_AdjustIFrameHeight(); }; // Delete event from database function delete_event(i) { var id = events_module[i].id; $.ajax({ url: "http://www.igoogleportal.com/gadget/calendar/set-calendar.php", data: {id: id, action:'DELETE'}, type: "POST", dataType: 'XML', cache: false, async: true, success: function (data, textStatus, jqXHR) { $(data).find('header').each(function () { var status = parseInt($(this).find('status').text()); var l_s = $(this).find('msg').text(); $("#error_msg").empty(); $("#error_msg").append(l_s); if (status) { events_module.splice(i, 1); } displayMonth_module(); }); } }); } noopt_module(); // Start execution here gadgets.util.registerOnLoadHandler(get_module); </script> </head> <body> <div id="ev_module" style="padding: 6px;" align="center"></div> <div id="ev_list_module"></div> <div id="addb_module"></div> <div id="error_msg" class="error_msg" align="center"></div> </body>
]]>
</Content>
</Module>


